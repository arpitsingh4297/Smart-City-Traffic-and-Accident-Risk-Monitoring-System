# Smart-City-Traffic-and-Accident-Risk-Monitoring-System

Predicting Accident Severity for Smarter and Safer Cities

SafeCity Predictor is a Smart City Traffic and Accident Risk Monitoring System designed to predict the severity of road accidents in India. By leveraging machine learning, this project aims to enhance urban safety through data-driven insights and real-time risk assessment. The system includes a Streamlit-based web application that allows users to input accident details and predict whether an accident is likely to be Fatal, Minor, or Serious.
Table of Contents

Project Overview
Features
Installation
Usage
File Structure
Dataset
Model Training
Deployment
Contributing
License
Contact

Project Overview
SafeCity Predictor uses machine learning to analyze historical accident data and predict accident severity based on features like weather conditions, road type, lighting conditions, and driver demographics. The project includes a training notebook (Untitled4.ipynb) to preprocess data, train a Logistic Regression model, and save preprocessing objects, and a Streamlit app (app_new.py) for interactive predictions.
This project was developed as part of a smart city initiative to improve traffic safety through predictive analytics. The current model achieves an F1-score of 0.3478, and future improvements are planned to enhance prediction accuracy.
Features

Accident Severity Prediction: Predicts whether an accident is Fatal, Minor, or Serious using a trained Logistic Regression model.
Interactive Web App: A user-friendly Streamlit app (app_new.py) for inputting accident details and viewing predictions.
Feature Engineering: Includes data cleaning, outlier treatment, categorical encoding, and feature selection using Recursive Feature Elimination (RFE).
Model Insights: Displays Logistic Regression coefficients and RFE-selected features for interpretability.
Business Insights: Provides actionable recommendations for traffic management, such as real-time weather alerts and stricter speed controls.
Input Validation: Ensures realistic inputs (e.g., Number of Fatalities cannot exceed Number of Casualties).
Low Confidence Warning: Alerts users when the model’s prediction confidence is low (below 50%).

Installation
Follow these steps to set up the project locally.
Prerequisites

Python 3.8 or higher
Git
Anaconda (optional, but recommended for managing environments)

Steps

Clone the Repository:
git clone https://github.com/yourusername/safecity-predictor.git
cd safecity-predictor


Create a Virtual Environment:Using venv:
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

Or using Anaconda:
conda create -n safecity_env python=3.8
conda activate safecity_env


Install Dependencies:Install the required Python packages listed in requirements.txt:
pip install -r requirements.txt

If requirements.txt is not present, install the following packages:
pip install pandas numpy matplotlib seaborn scikit-learn imblearn kmodes xgboost streamlit joblib statsmodels


Verify Installation:Ensure all .pkl files (best_model.pkl, scaler.pkl, selected_features.pkl, label_encoder.pkl, encoders.pkl, feature_options.pkl) are in the project directory. These files are generated by running the training notebook (Untitled4.ipynb).


Usage
1. Train the Model (Optional)
If you want to retrain the model or generate new .pkl files:

Open Untitled4.ipynb in Jupyter Notebook.
Ensure the dataset accident_prediction_india.csv is in the project directory.
Run all cells to preprocess the data, train the Logistic Regression model, and save the .pkl files.
Output files will be saved in the project directory.

2. Run the Streamlit App
To use the prediction app:

Activate your virtual environment:source venv/bin/activate  # On Windows: venv\Scripts\activate
# Or: conda activate safecity_env


Run the Streamlit app:streamlit run app_new.py


Open your browser and navigate to http://localhost:8501.

3. Input Accident Details
In the Streamlit app sidebar:

Select or enter values for features like State Name, Number of Vehicles Involved, Weather Conditions, etc.
Click "Predict Accident Severity" to view the prediction.

Example Input

State Name: Jammu and Kashmir
Number of Vehicles Involved: 1
Vehicle Type Involved: Cycle
Number of Casualties: 0
Number of Fatalities: 0
Weather Conditions: Hazy
Lighting Conditions: Dark
Speed Limit (km/h): 50
Driver Age: 30
Accident Location Details: Curve

Expected Output:

Predicted Accident Severity: Fatal
Prediction Probabilities: Fatal (36.64%), Minor (29.84%), Serious (33.52%)
Warning: Low confidence due to close probabilities and low F1-score (0.3478).

File Structure
safecity-predictor/
│
├── accident_prediction_india.csv  # Dataset (not included in repo, add manually)
├── Untitled4.ipynb                # Training notebook for data preprocessing and model training
├── app_new.py                     # Streamlit app for accident severity prediction
├── best_model.pkl                 # Trained Logistic Regression model
├── scaler.pkl                     # StandardScaler for numerical features
├── selected_features.pkl          # RFE-selected features
├── label_encoder.pkl              # LabelEncoder for target variable
├── encoders.pkl                   # LabelEncoders for categorical features
├── feature_options.pkl            # Unique values for categorical features (for dropdowns)
├── requirements.txt               # List of Python dependencies (create manually if needed)
└── README.md                      # Project documentation

Dataset
The project uses accident_prediction_india.csv, a dataset containing historical accident data from India. Due to privacy and size constraints, the dataset is not included in the repository. You can add your own dataset with the following columns:

State Name
City Name
Weather Conditions
Road Type
Road Condition
Lighting Conditions
Traffic Control Presence
Driver Gender
Driver License Status
Alcohol Involvement
Accident Location Details
Vehicle Type Involved
Number of Vehicles Involved
Number of Casualties
Number of Fatalities
Speed Limit (km/h)
Driver Age
Accident Severity (Target: Fatal, Minor, Serious)
Additional columns like Year, Month, Day of Week, Time of Day (dropped during preprocessing)

Ensure the dataset is placed in the project directory before running Untitled4.ipynb.
Model Training
The training process is detailed in Untitled4.ipynb:

Data Cleaning: Handles missing values and outliers.
Exploratory Data Analysis (EDA): Visualizes distributions and correlations.
Feature Engineering: Encodes categorical variables and scales numerical features.
Feature Selection: Uses RFE to select the top 10 features.
Clustering: Applies K-Prototypes for risk profiling.
Model Training: Trains multiple models (Logistic Regression, Random Forest, etc.) and selects the best (Logistic Regression, F1-score: 0.3478).
Hyperparameter Tuning: Uses GridSearchCV to optimize the model.
Model Interpretation: Extracts coefficients for interpretability.
Saving Artifacts: Saves the model and preprocessing objects as .pkl files.

Deployment
To deploy the app on Streamlit Cloud:

Push the repository to GitHub:git add .
git commit -m "Initial commit"
git push origin main


Sign in to Streamlit Cloud with your GitHub account.
Create a new app and link it to your repository.
Specify app_new.py as the main script.
Ensure all .pkl files are uploaded to the repository.
Add a requirements.txt file with the following content:pandas
numpy
matplotlib
seaborn
scikit-learn
imblearn
kmodes
xgboost
streamlit
joblib
statsmodels


Deploy the app and access it via the provided URL.

Contributing
Contributions are welcome! To contribute:

Fork the repository.
Create a new branch:git checkout -b feature/your-feature-name


Make your changes and commit:git commit -m "Add your feature"


Push to your fork:git push origin feature/your-feature-name


Open a pull request with a detailed description of your changes.

Potential Improvements

Enhance model accuracy by experimenting with other algorithms (e.g., Random Forest, XGBoost).
Add interaction features (e.g., Weather Conditions * Lighting Conditions).
Improve the dataset with more recent or diverse data.
Add real-time data integration with IoT traffic sensors.

License
This project is licensed under the MIT License. See the LICENSE file for details.
Contact
For questions or suggestions, please reach out:  

Author: Arpit Singh
Email: arpitsingh4297@gmail.com 
GitHub: arpitsingh4297

Built with ❤️ for safer cities | Last Updated: May 21, 2025
